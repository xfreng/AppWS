<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>首页</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/style.css"/>
    <link rel="stylesheet" type="text/css" href="../../mui/css/mui.min.css">
    <link rel="stylesheet" type="text/css" href="../../css/app.css">
    <style>
		.empty{ text-align: center; padding: 120px 0;}
    </style>
</head>
<body>
	<div id="slider" class="mui-slider">
		<div class="mui-slider-group mui-slider-loop">
			<!-- 额外增加的一个节点(循环轮播：第一个节点是最后一张轮播) -->
			<div class="mui-slider-item mui-slider-item-duplicate">
				<a href="#">
					<img src="../../image/banner/yuantiao.jpg">
				</a>
			</div>
			<!-- 第一张 -->
			<div class="mui-slider-item">
				<a href="#">
					<img src="../../image/banner/shuijiao.jpg">
				</a>
			</div>
			<!-- 第二张 -->
			<div class="mui-slider-item">
				<a href="#">
					<img src="../../image/banner/muwu.jpg">
				</a>
			</div>
			<!-- 第三张 -->
			<div class="mui-slider-item">
				<a href="#">
					<img src="../../image/banner/cbd.jpg">
				</a>
			</div>
			<!-- 第四张 -->
			<div class="mui-slider-item">
				<a href="#">
					<img src="../../image/banner/yuantiao.jpg">
				</a>
			</div>
			<!-- 额外增加的一个节点(循环轮播：最后一个节点是第一张轮播) -->
			<div class="mui-slider-item mui-slider-item-duplicate">
				<a href="#">
					<img src="../../image/banner/shuijiao.jpg">
				</a>
			</div>
		</div>
		<div class="mui-slider-indicator">
			<div class="mui-indicator mui-active"></div>
			<div class="mui-indicator"></div>
			<div class="mui-indicator"></div>
			<div class="mui-indicator"></div>
		</div>
	</div>
    <div><button class="mui-btn mui-btn-primary" onclick="postInfo()">测试发送报文</button></div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/core-min.js"></script>
<script type="text/javascript" src="../../script/md5.js"></script>
<script type="text/javascript" src="../../script/tripledes.js"></script>
<script type="text/javascript" src="../../script/mode-ecb.js"></script>
<script type="text/javascript" src="../../script/fui.js"></script>
<script type="text/javascript" src="../../mui/js/mui.min.js"></script>
<script type="text/javascript">
	var keyLength = $api.getStorage('keyLength');
	var secretKey = $api.getStorage('secretKey');
	var serviceUrl = $api.getStorage('serviceUrl');
	var fileUploadServiceUrl = $api.getStorage('fileUploadServiceUrl');
	var machineCode = $api.getStorage('machineCode');
	var device = $api.getStorage('device');
	function postInfo(){
		var transCode = "1001";
		var data = {
            "header":{"transcode":transCode},
            "body":{
                "device":device,
                "appKey":transCode,
                "machineCode":machineCode,
                "uid":"9",
                "token":"jBm5Ev9g",
                "userName": "苏先生",
                "card": "450521199808084949",
                "income": "100",
                "userEmail": "123456@qq.com",
                "area": "湖南省,长沙市",
                "contact": "18977999999",
                "relation": "2",
                "userMarriage": "2",
                "userChsi": "2"
            }
        };
        var md5key = encryptByMd5(JSON.stringify(data)+transCode).toUpperCase();
		api.ajax({
		    url: serviceUrl,
		    method: 'post',
		    data: {
		        values: {
		            "data": md5key+encryptByDES(JSON.stringify(data),secretKey)
		        }
		    },
			dataType: "json"
		}, function(ret, err) {
		    if (ret) {
        		var dataJsonEncrypt = ret.data.substring(keyLength);
        		var decryptData = decryptByDES(dataJsonEncrypt,secretKey);
		        api.alert({ msg: decryptData });
		    } else {
		    	var dataJsonEncrypt = err.data.substring(keyLength);
		    	var decryptData = decryptByDES(dataJsonEncrypt,secretKey);
		        api.alert({ msg: decryptData });
		    }
		});
	}

    apiready = function () {
		//mui
		mui.init({
			swipeBack:true //启用右滑关闭功能
		});
		var slider = mui("#slider");
		slider.slider({
			interval: 5000 //每隔5秒调用一次
		});
	}
</script>
</html>